<section class="bg-neutral-100 dark:bg-neutral-950 text-neutral-800 dark:text-neutral-200 min-h-screen py-10 px-4">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-2">

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">

            <div class="lg:col-span-5 space-y-6">

                <div
                    class="bg-white dark:bg-neutral-900 p-6 rounded-2xl shadow-sm border border-neutral-200 dark:border-neutral-800">
                    <h2 class="text-xl font-bold mb-4 text-cyan-600 dark:text-cyan-400">Datos Personales</h2>

                    <form [formGroup]="profileForm" (ngSubmit)="updateProfile()" class="space-y-4">

                        <div class="grid grid-cols-2 gap-4">
                            <div class="space-y-1">
                                <label class="text-xs font-bold uppercase text-neutral-500">Nombre</label>
                                <input type="text" formControlName="nombre"
                                    class="w-full rounded-xl border border-neutral-300 dark:border-neutral-700 bg-neutral-50 dark:bg-neutral-800 px-3 py-2 text-sm focus:ring-2 focus:ring-cyan-400 outline-none">
                            </div>
                            <div class="space-y-1">
                                <label class="text-xs font-bold uppercase text-neutral-500">Apellido</label>
                                <input type="text" formControlName="apellido"
                                    class="w-full rounded-xl border border-neutral-300 dark:border-neutral-700 bg-neutral-50 dark:bg-neutral-800 px-3 py-2 text-sm focus:ring-2 focus:ring-cyan-400 outline-none">
                            </div>
                        </div>

                        <div class="space-y-1">
                            <label class="text-xs font-bold uppercase text-neutral-500">Teléfono</label>
                            <input type="tel" formControlName="phone"
                                class="w-full rounded-xl border border-neutral-300 dark:border-neutral-700 bg-neutral-50 dark:bg-neutral-800 px-3 py-2 text-sm focus:ring-2 focus:ring-cyan-400 outline-none">
                        </div>

                        <div class="grid grid-cols-3 gap-4">
                            <div class="space-y-1 col-span-1">
                                <label class="text-xs font-bold uppercase text-neutral-500">Tipo Doc.</label>

                                <select formControlName="documentType" tabindex="-1"
                                    class="w-full rounded-xl border border-neutral-200 dark:border-neutral-800 bg-neutral-200/50 dark:bg-neutral-800/50 px-2 py-2 text-sm text-neutral-500 dark:text-neutral-500 outline-none pointer-events-none cursor-not-allowed appearance-none">
                                    <option value="DNI">DNI</option>
                                    <option value="PASSPORT">Pasaporte</option>
                                    <option value="CE">CE</option>
                                </select>
                            </div>

                            <div class="space-y-1 col-span-2">
                                <label class="text-xs font-bold uppercase text-neutral-500">Nro Documento</label>

                                <input type="text" formControlName="documentNumber" readonly
                                    class="w-full rounded-xl border border-neutral-200 dark:border-neutral-800 bg-neutral-200/50 dark:bg-neutral-800/50 px-3 py-2 text-sm text-neutral-500 dark:text-neutral-500 outline-none cursor-not-allowed focus:ring-0">
                            </div>
                        </div>

                        <div class="pt-2">
                            <button type="submit" [disabled]="profileForm.invalid || savingProfile"
                                class="w-full py-2.5 rounded-xl bg-neutral-900 dark:bg-neutral-100 text-white dark:text-neutral-900 font-bold hover:opacity-90 transition disabled:opacity-50">
                                {{ savingProfile ? 'Guardando...' : 'Actualizar Datos' }}
                            </button>
                        </div>
                    </form>
                </div>

                <div class="bg-red-50 dark:bg-red-900/10 p-6 rounded-2xl border border-red-200 dark:border-red-900/30">
                    <h3 class="text-sm font-bold text-red-600 dark:text-red-400 mb-2">Eliminar Cuenta</h3>
                    <p class="text-xs text-neutral-600 dark:text-neutral-400 mb-4">
                        Esta acción borrará permanentemente tu historial de pedidos y datos personales.
                    </p>
                    <button (click)="deleteAccount()"
                        class="text-xs font-bold text-red-600 hover:text-red-800 hover:underline">
                        Eliminar mi cuenta definitivamente
                    </button>
                </div>

            </div>

            <div class="lg:col-span-7">
                <div
                    class="bg-white dark:bg-neutral-900 p-6 rounded-2xl shadow-sm border border-neutral-200 dark:border-neutral-800 h-full flex flex-col">

                    <div class="flex items-center justify-between mb-6 shrink-0">
                        <h2 class="text-xl font-bold text-cyan-600 dark:text-cyan-400">Mis Direcciones</h2>
                        <button (click)="openAddressDialog()"
                            class="inline-flex items-center gap-1 px-3 py-1.5 bg-cyan-100 dark:bg-cyan-900/30 text-cyan-700 dark:text-cyan-300 rounded-lg text-sm font-bold hover:bg-cyan-200 transition">
                            <mat-icon
                                class="!text-lg !w-5 !h-5 flex items-center justify-center leading-none">add</mat-icon>
                            Nueva
                        </button>
                    </div>

                    <div class="space-y-4 overflow-y-auto max-h-[400px] pr-2 custom-scrollbar">

                        <div *ngIf="loadingDir" class="space-y-3 animate-pulse">
                            <div class="h-20 bg-neutral-100 dark:bg-neutral-800 rounded-xl"></div>
                            <div class="h-20 bg-neutral-100 dark:bg-neutral-800 rounded-xl"></div>
                        </div>

                        <div *ngIf="!loadingDir && direcciones.length === 0" class="text-center py-10 text-neutral-500">
                            <mat-icon class="!text-4xl !w-10 !h-10 mb-2 opacity-50 ">location_off</mat-icon>
                            <p>No tienes direcciones registradas.</p>
                        </div>

                        <div *ngFor="let dir of direcciones"
                            class="group relative flex items-start justify-between p-5 rounded-2xl border border-neutral-200 dark:border-neutral-800 bg-white dark:bg-neutral-900 hover:border-cyan-400 dark:hover:border-cyan-500 hover:shadow-md transition-all duration-300">

                            <div class="flex gap-4">
                                <div
                                    class="shrink-0 mt-0.5 h-10 w-10 flex items-center justify-center rounded-full bg-cyan-50 dark:bg-cyan-900/20 text-cyan-600 dark:text-cyan-400">
                                    <mat-icon
                                        class="flex items-center justify-center leading-none">location_on</mat-icon>
                                </div>

                                <div class="space-y-1">
                                    <p class="text-base font-bold text-neutral-900 dark:text-neutral-100 leading-tight">
                                        {{ dir.calle }}
                                    </p>
                                    <p class="text-sm text-neutral-500 dark:text-neutral-400">
                                        {{ dir.distrito }}, {{ dir.provincia }} - {{ dir.departamento }}
                                    </p>
                                    <p *ngIf="dir.referencia"
                                        class="text-xs text-neutral-400 dark:text-neutral-500 flex items-center gap-1 pt-1">
                                        <mat-icon class="!text-xs !w-4 !h-4">info</mat-icon>
                                        <span>{{ dir.referencia }}</span>
                                    </p>
                                </div>
                            </div>

                            <div
                                class="flex items-center gap-1 opacity-100 lg:opacity-0 lg:group-hover:opacity-100 transition-opacity duration-200 absolute top-4 right-4 lg:static">
                                <button (click)="openAddressDialog(dir)" matTooltip="Editar"
                                    class="p-2 rounded-lg text-neutral-400 hover:text-indigo-500 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 transition-colors">
                                    <mat-icon
                                        class="!text-lg !w-5 !h-5 flex items-center justify-center">edit</mat-icon>
                                </button>
                                <button (click)="deleteAddress(dir.id!)" matTooltip="Eliminar"
                                    class="p-2 rounded-lg text-neutral-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors">
                                    <mat-icon
                                        class="!text-lg !w-5 !h-5 flex items-center justify-center">delete</mat-icon>
                                </button>
                            </div>
                        </div>

                    </div>

                </div>
            </div>

        </div>
    </div>
</section>